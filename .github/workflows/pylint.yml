name: Pylint Workflow

on:
  push:
    branches:
      - 'main'
  pull_request:
    branches:
      - 'main'

jobs:
  pylint:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Set up Python 3.13
      uses: actions/setup-python@v3
      with:
        python-version: "3.13.0-rc.1"

    - name: Install Pylint
      run: |
        pip install pylint
        pylint hw2_debugging.py > pylint_report.txt

    - name: Generate Pylint badge
      run: |
        pylint_score=$(grep -oP 'Your code has been rated at \K[0-9.]+\/10' pylint_report.txt)
        echo "https://img.shields.io/badge/pylint-${pylint_score}-brightgreen" > pylint_badge.txt

    - name: Commit Pylint badge
      run: |
        git config user.name "github-actions"
        git config user.email "github-actions@github.com"
        git add pylint_report.txt pylint_badge.txt
        git commit -m "Update Pylint Badge"
        git push
